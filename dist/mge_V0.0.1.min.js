const mge={TITLE:'Mini Game Engine',VERSION:'V0.0.1',bj:{},bv:{},ch:{},dc:{},dp:{},cnboard:{}};mge.audio={get currentAudioTime(){return mge.bj.ai.currentTime},get volume(){return mge.bj.aq},set volume(_value){mge.bj.be(_value)},playSound:function(al,an,ad,ae,aq){mge.bj.ak(al,mge.bj.aj,an,ad,ae,aq)}};mge.game={get width(){return mge.bv.bo.width},set width(_value){mge.bv.bo.width=_value},get height(){return mge.bv.bo.height},set height(_value){mge.bv.bo.height=_value},get fps(){return mge.dc.cx},start:function(ce){mge.ch.cf(ce)},changeScene:function(ce){mge.ch.cd(ce)},createSprite:function(){return mge.ch.ahSprite()}};mge.keyboard={get keysPressed(){return mge.cnboard.ck},isKeyPressed:function(cn){return mge.cnboard.cl(cn)}};mge.mouse={get isClicked(){return mge.dp.df},get x(){return mge.dp._x},get y(){return mge.dp._y}};mge.er={set drawFunction(_value){this.ds=_value},get width(){return this.bl},set width(_value){this.bl=_value},get height(){return this.bm},set height(_value){this.bm=_value},get x(){return this._x},set x(_value){this._x=_value},get y(){return this._y},set y(_value){this._y=_value},get scaleX(){return this.bs},set scaleX(_value){this.bs=_value},get scaleY(){return this.bt},set scaleY(_value){this.bt=_value},get isVisible(){return this.dx},set isVisible(_value){this.dx=_value},get drawBoundaries(){return this.dy},set drawBoundaries(_value){this.dy=_value},get isTouched(){return this.ek(mge.dp._x,mge.dp._y)},get isClicked(){return this.df(mge.dp._x,mge.dp._y,mge.dp.df)},draw:function(){this.dz()},isColliding:function(eb){return this.ea(eb)}};mge.bj.aa=function(ab,ac,ad,ae){let a=ab.a||0.0001;let d=ab.d||0.0001;let s=ab.s||0.0001;let r=ab.r||0.0001;let af=ab.minValue||0.0001;let ag=ab.maxValue||1;if(ae<=a){ac.setValueAtTime(af,ad);ac.exponentialRampToValueAtTime(ag*ae/a,ad+ae);ac.exponentialRampToValueAtTime(af,ad+ae+r)}else if(ae<=a+d){ac.setValueAtTime(af,ad);ac.exponentialRampToValueAtTime(ag,ad+a);ac.exponentialRampToValueAtTime(ag*s*d/ae,ad+ae);ac.exponentialRampToValueAtTime(af,ad+ae+r)}else{ac.setValueAtTime(af,ad);ac.exponentialRampToValueAtTime(ag,ad+a);ac.exponentialRampToValueAtTime(ag*s,ad+a+d);ac.setValueAtTime(ag*s,ad+ae);ac.exponentialRampToValueAtTime(af,ad+ae+r)}};mge.bj.ah=function(){this.ai='';this.aj='';this.aq=1;this.ai=new(window.AudioContext||window.webkitAudioContext)();this.aj=this.ai.createGain();this.aj.connect(this.ai.destination)};mge.bj.ak=function(al,am,an,ad,ae,aq){let aa=this.aa;let as=this.ai;let at=al.oscType||'sine';let au=al.filterType||'lowpass';let aqADSR=al.volumeADSR||{a:0,d:0,s:1,r:0,minValue:1,maxValue:1};let aw=al.pitchADSR||{a:0,d:0,s:1,r:0,minValue:an,maxValue:an};let ax=al.detuneADSR||{a:0,d:0,s:1,r:0,minValue:0,maxValue:0};let ay=al.filterFreqADSR||{a:0,d:0,s:1,r:0,minValue:20000,maxValue:20000};let az=al.filterQADSR||{a:0,d:0,s:1,r:0,minValue:1,maxValue:1};let bd='';if(at=='noise'){bd=as.createBufferSource();let buffer=as.createBuffer(1,as.sampleRate*(ae+aqADSR.r),as.sampleRate);let noiseOutput=buffer.getChannelData(0);for(let i=0;i<buffer.length;i++){noiseOutput[i]=Math.random()*2-1};osc.buffer=buffer;}else{bd=as.createOscillator();bd.type=at;aa(aw,bd.frequency,ad,ae);aa(ax,bd.detune,ad,ae)};bd.start(ad);bd.stop(ad+ae+aqADSR.r);let ba=as.createGain();aa(aqADSR,ba.gain,ad,ae);let bb=as.createGain();bb.gain.setValueAtTime(mge.bj.aqToGain(aq),ad);let bc=as.createBiquadFilter();bc.type=au;aa(ay,bc.frequency,ad,ae);aa(az,bc.Q,ad,ae);bd.connect(bc);bc.connect(ba);ba.connect(bb);bb.connect(am)};mge.bj.be=function(aq){if(aq<=0){mge.bj.aq=0}else if(aq>=1){mge.bj.aq=1}else{mge.bj.aq=aq};mge.bj.aj.gain.setValueAtTime(mge.bj.aqToGain(mge.bj.aq),mge.audio.currentAudioTime)};mge.bj.aqToGain=function(aq){let bi=30;if(aq<=0){return 0;}else if(aq>=1){return 1;}else{return Math.pow(10,(aq-1)*bi/10)}};mge.bv.ah=function(bl,bm,bn){this.bo='';this.bp='';this.bo=document.getElementById(bn);if(this.bo){this.bo.remove()};this.bo=document.createElement('canvas');this.bo.id=bn;this.bo.width=bl;this.bo.height=bm;document.body.appendChild(this.bo);this.bp=this.bo.getContext('2d')};mge.bv.bq=function(){let br=this.bo;let bs=window.innerWidth/br.width;let bt=window.innerHeight/br.height;let bu=Math.min(bs,bt);br.style.transformOrigin='0 0';br.style.transform='scale('+bu+')';br.display='block'};mge.ch.ah=function(bl,bm){this.bz='';this.ca='';let bv=mge.bv;let bj=mge.bj;let dc=mge.dc;let dp=mge.dp;let cnboard=mge.cnboard;bv.ah(bl,bm,'GAME_RENDER_CANVAS');dp.ah(bv.bo);cnboard.ah();bj.ah();dc.ah()};mge.ch.ahSprite=function(){let er=mge.er;let bv=mge.bv;let bp=bv.bp;let _newSprite=Object.create(er);_newSprite.ah(bp);return _newSprite};mge.ch.cd=function(ce){if(!ce.start){ce.start=function(){}};if(!ce.update){ce.update=function(){}};if(!ce.draw){ce.draw=function(){}};this.ca=ce};mge.ch.cf=function(ce){let dc=mge.dc;this.cd(ce);dc.cf()};mge.cnboard.cl=function(cn){if(this.ck.indexOf(cn)==-1){return false;}else{return true}};mge.cnboard.cm=function(e){let cn=e.key;if(this.cj.indexOf(cn)==-1){this.cj.push(cn)}};mge.cnboard.co=function(e){let cn=e.key;let indexOfKey=this.cj.indexOf(cn);if(indexOfKey !=-1){this.cj.splice(indexOfKey,1)}};mge.cnboard.cq=function(){this.ck=[];this.cj=[]};mge.cnboard.cr=function(){this.ck=this.cj.slice()};mge.cnboard.ah=function(){this.ck=[];this.cj=[];document.onkeydown=function(e){mge.cnboard.cm(e)};document.onkeyup=function(e){mge.cnboard.co(e)}};mge.dc.ah=function(){this.cu=0;this.cv=0;this.cw=0;this.cx=0;this.cy='stopped'};mge.dc.cf=function(){this.cy='running';this.db()};mge.dc.da=function(){this.cy='stopped';this.db()};mge.dc.db=function(){let bv=mge.bv;let ch=mge.ch;let dp=mge.dp;let cnboard=mge.cnboard;let bp=bv.bp;let bo=bv.bo;let dc=mge.dc;dc.cv=performance.now();dc.cw=dc.cv-dc.cu;dc.cx=1/(dc.cw/1000);dp.cr();cnboard.cr();if(ch.bz !=ch.ca){ch.bz=ch.ca;dp.cq();cnboard.cq();ch.bz.start()};ch.bz.update();bp.clearRect(0,0,bo.width,bo.height);ch.bz.draw();bv.bq();dc.cu=dc.cv;if(dc.cy=='running'){requestAnimationFrame(dc.db)}};mge.dp.dj=function(e){this.di=true;this.dg=e.offsetX;this.dh=e.offsetY};mge.dp.dk=function(e){this.dg=e.offsetX;this.dh=e.offsetY};mge.dp.dl=function(e){this.dg='';this.dh=''};mge.dp.cq=function(){this._x=0;this._y=0;this.df=false;this.dg=0;this.dh=0;this.di=false};mge.dp.cr=function(){this._x=this.dg;this._y=this.dh;this.df=this.di;this.di=false};mge.dp.ah=function(br){this._x=0;this._y=0;this.df=false;this.dg=0;this.dh=0;this.di=false;br.onclick=function(e){mge.dp.dj(e)};br.onmousemove=function(e){mge.dp.dk(e)};br.onmouseout=function(e){mge.dp.dl(e)}};mge.er.ah=function(dr){this.dr=dr;this.ds=function(){};this.bl=100;this.bm=100;this._x=0;this._y=0;this.bs=1;this.bt=1;this.dx=true;this.dy=false};mge.er.dz=function(){if(this.dx){let dr=this.dr;dr.save();dr.translate(this._x-this.bl*this.bs/2,this._y-this.bm*this.bt/2);dr.scale(this.bs,this.bt);this.ds(dr);if(this.dy){dr.strokeStyle='red';dr.strokeRect(0,0,this.bl,this.bm);dr.strokeRect(this.bl/2,this.bm/2,1,1)};dr.restore()}};mge.er.df=function(eh,ei,ej){if(this.ek(eh,ei)&& ej){return true;}else{return false}};mge.er.ea=function(eb){let ec=(this.bl/2)*this.bs+(eb.bl/2)*eb.bs;let ed=(this.bm/2)*this.bt+(eb.bm/2)*eb.bt;let ee=Math.abs(this._x-eb._x);let ef=Math.abs(this._y-eb._y);if(ee<ec && ef<ed){return true;}else{return false}};mge.er.ek=function(eh,ei){let en=this._x+(this.bl/2)*this.bs;let eo=this._x-(this.bl/2)*this.bs;let ep=this._y+(this.bm/2)*this.bt;let eq=this._y-(this.bm/2)*this.bt;if(eh>=eo && eh<=en && ei>=eq && ei<=ep){return true;}else{return false}};mge.ch.ah(640,360)